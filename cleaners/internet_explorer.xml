<?xml version="1.0" encoding="UTF-8"?>
<!--

    BleachBit
    Copyright (C) 2008-2019 Andrew Ziem
    https://www.bleachbit.org

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see <http://www.gnu.org/licenses/>.

	Rules in CleanerML written/updated by https://github.com/Tobias-B-Besemer
	Done on 2019-03-07

-->
<cleaner id="internet_explorer" os="windows">
  <label>Internet Explorer</label>
  <description>Web browser</description>
  <option id="cookies">
    <label>Cookies</label>
    <description>Delete cookies, which contain information such as web site preferences, authentication, and tracking identification</description>
    <action command="delete" search="walk.files" path="%USERPROFILE%\Cookies\"/>
    <action command="delete" search="walk.files" path="%APPDATA%\Microsoft\Windows\Cookies\"/>
    <action command="delete" search="walk.files" path="%LOCALAPPDATA%\Microsoft\Internet Explorer\DOMStore\"/>
    <action command="delete" search="walk.files" path="%USERPROFILE%\AppData\LocalLow\Microsoft\Internet Explorer\DOMStore\"/>
  </option>
  <option id="forms">
    <label>Form history</label>
    <!-- Internet Explorer 7 and 8 -->
    <description>A history of forms entered in web sites and in the Search bar</description>
    <action command="winreg" path="HKCU\Software\Microsoft\Internet Explorer\IntelliForms\Storage1"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Internet Explorer\IntelliForms\Storage2"/>
  </option>
  <option id="history">
    <label>History</label>
    <description>List of visited web pages</description>
    <action command="delete" search="walk.files" path="%USERPROFILE%\AppData\Local\Microsoft\Windows\History\"/>
    <action command="delete" search="walk.files" path="%USERPROFILE%\Local Settings\History\"/>
    <action command="delete" search="walk.files" path="%LOCALAPPDATA%\Microsoft\Internet Explorer\Recovery\Active\"/>
    <action command="delete" search="walk.files" path="%LOCALAPPDATA%\Microsoft\Internet Explorer\Recovery\Immersive\Active\"/>
    <action command="delete" search="walk.files" path="%LOCALAPPDATA%\Microsoft\Internet Explorer\Recovery\Last Active\"/>
    <!-- "How to clear the History entries in Internet Explorer", http://support.microsoft.com/kb/157729 -->
    <action command="winreg" path="HKCU\Software\Microsoft\Internet Explorer\TypedURLs"/>
  </option>
  <option id="temporary_files">
    <label>Temporary files</label>
    <description>Delete the temporary files</description>
    <!-- Was: <action command="delete" search="walk.files" path="%APPDATA%\Microsoft\Windows\IETldCache\"/> -->
    <action command="delete" search="walk.all" path="%APPDATA%\Microsoft\Windows\IETldCache\"/> <!-- Used e.g. in Win7 -->

    <!-- Was: <action command="delete" search="walk.files" path="%USERPROFILE%\AppData\Local\Microsoft\Windows\Temporary Internet Files\"/> -->
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\Temporary Internet Files\"/> <!-- Used e.g. in Win7 -->
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Windows\Temporary Internet Files\"/>

    <!-- Windows 7 Support: -->
    <action command="delete" search="walk.all" path="%AppData%\Microsoft\Internet Explorer\UserData\"/>
    <action command="delete" search="glob" path="%AppData%\Microsoft\Internet Explorer\UserData\"/>
    <action command="delete" search="walk.all" path="%AppData%\Microsoft\Windows\IECompatUACache\"/>
    <action command="delete" search="walk.all" path="%AppData%\Microsoft\Windows\IECompatCache\"/>
    <action command="delete" search="walk.files" path="%LocalAppData%\Microsoft\Windows\WebCache\"/>
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\WebCache.old\"/>
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Windows\WebCache.old\"/>

    <!-- Windows XP Support: -->
    <!-- Was, and didn't worked: -->
    <!-- <action command="delete" search="walk.files" path="%USERPROFILE%\Local Settings\Temporary Internet Files\"/> -->
    <action command="delete" search="walk.all" path="%USERPROFILE%\Local Settings\Temporary Internet Files\"/>
    <action command="delete" search="glob" path="%USERPROFILE%\Local Settings\Temporary Internet Files\*"/>

    <!-- Deletes Feeds Cache: -->
    <action command="delete" search="walk.files" path="%LOCALAPPDATA%\Microsoft\Feeds Cache\"/>
  </option>
  <option id="downloads">
    <label>Downloads history</label>
    <description>Deletes the Downloads history</description>
    <action command="delete" search="walk.all" path="%APPDATA%\Microsoft\Windows\IEDownloadHistory\"/> <!-- Used e.g. in Win7 -->
  </option>
</cleaner>
