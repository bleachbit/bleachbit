version: 1.0.{build}
branches:
  only:
  - utf8filenames

environment:
    PYTHON_HOME: 'C:/Python27'
    SZ_EXE   :   '"C:/Program Files/7-Zip/7z.exe"'
    make : 'C:/MinGW/bin/mingw32-make.exe'


init:
  - 'echo PYTHON_HOME=%PYTHON_HOME%'
  - '%PYTHON_HOME%/python.exe -V'
  - '%PYTHON_HOME%/Scripts/pip.exe --version'


install:
  - 'dir "C:/Program Files/7-Zip/"'
  - '%PYTHON_HOME%\Scripts\pip.exe install pypiwin32'
  - '%PYTHON_HOME%\Scripts\pip.exe install py2exe_py2'
  - ps: Start-FileDownload "http://ftp.gnome.org/pub/GNOME/binaries/win32/pygtk/2.24/pygtk-all-in-one-2.24.2.win32-py2.7.msi"
  - 'msiexec /i pygtk-all-in-one-2.24.2.win32-py2.7.msi /qn /norestart /log pygtk-install.log TARGETDIR=C:\Python27 ALLUSERS=1'
  - ps: Start-FileDownload "http://github.com/upx/upx/releases/download/v3.92/upx392w.zip"
  - '%SZ_EXE% x upx392w.zip -oupx392w'
  - '%make% -C po local'
  - '%PYTHON_HOME%/python.exe  windows\\setup_py2exe.py'


cache:
  - pygtk-all-in-one-2.24.2.win32-py2.7.msi

test_script:
